In[1]: get_ipython().magic(u'cd "checking david\'s matrices/"')
In[2]: p = 10**-4 * parse('pam1.txt')
In[3]: from matrices import *
In[4]: p = 10**-4 * parse('pam1.txt')
In[5]: p**2
Out[5]: {('S', 'W'): 0.00099220999999999988, ('G', 'G'): 0.98705204000000013, ('E', 'M'): 0.00020169000000000003, ('A', 'N'): 0.0017981800000000004, ('A', 'Y'): 0.00039936000000000003, ('W', 'Q'): 2.4000000000000003e-07, ('V', 'N'): 0.00020436000000000003, ('F', 'K'): 1.0400000000000002e-06, ('G', 'E'): 0.0013986000000000001, ('E', 'D'): 0.01105189, ('W', 'P'): 2.5000000000000004e-07, ('I', 'T'): 0.0013875400000000005, ('F', 'D'): 8.9000000000000016e-07, ('K', 'V'): 0.00020318000000000002, ('C', 'Y'): 0.00059777000000000018, ('G', 'D'): 0.0021896500000000005, ('T', 'N'): 0.0025779800000000001, ('W', 'W'): 0.99520602000000002, ('S', 'S'): 0.96829286000000014, ('K', 'C'): 1.6300000000000001e-06, ('E', 'F'): 1.1000000000000001e-06, ('N', 'L'): 0.00019934000000000003, ('A', 'K'): 0.00040538, ('Q', 'P'): 0.00119154, ('F', 'G'): 0.00019948000000000001, ('D', 'S'): 0.0010003400000000004, ('C', 'V'): 0.00039825000000000006, ('V', 'T'): 0.0019874100000000007, ('H', 'P'): 0.0005976200000000001, ('P', 'V'): 0.00040056, ('I', 'Q'): 0.00020065000000000003, ('Y', 'K'): 6.9000000000000028e-07, ('W', 'T'): 4.2000000000000006e-07, ('H', 'F'): 0.00039850000000000004, ('P', 'D'): 0.00020347, ('Q', 'R'): 0.0017858500000000005, ('D', 'Q'): 0.0012065500000000002, ('K', 'Q'): 0.0023857799999999997, ('D', 'F'): 9.5000000000000001e-07, ('V', 'W'): 8.0999999999999997e-07, ('T', 'C'): 0.00020327, ('A', 'F'): 0.00039981000000000006, ('T', 'H'): 0.00020362000000000001, ('A', 'Q'): 0.0015927199999999999, ('Q', 'T'): 0.0003993, ('V', 'F'): 0.00020505, ('F', 'C'): 1.3e-06, ('C', 'R'): 0.00019964000000000001, ('V', 'P'): 0.00059937000000000011, ('H', 'T'): 0.00020117000000000003, ('E', 'L'): 0.00020046000000000004, ('F', 'R'): 0.00019935000000000002, ('I', 'G'): 2.2400000000000002e-06, ('C', 'Q'): 7.4000000000000001e-07, ('Y', 'V'): 0.00019938000000000001, ('T', 'A'): 0.0043551800000000002, ('T', 'V'): 0.0017888400000000001, ('Q', 'V'): 0.00020065000000000003, ('S', 'K'): 0.0013953400000000003, ('K', 'K'): 0.98526873000000004, ('E', 'N'): 0.0014076000000000002, ('N', 'T'): 0.0017848300000000003, ('A', 'H'): 0.00040347000000000007, ('A', 'C'): 0.00060056000000000009, ('V', 'S'): 0.00040520000000000004, ('Q', 'H'): 0.0045544199999999991, ('H', 'S'): 0.00020347000000000006, ('Q', 'Y'): 1.6400000000000002e-06, ('P', 'N'): 0.00040349, ('I', 'Y'): 0.00020139000000000002, ('P', 'G'): 0.00040246000000000005, ('F', 'N'): 0.00020033000000000003, ('H', 'N'): 0.0035553800000000003, ('K', 'H'): 0.0004094399999999999, ('N', 'W'): 0.00019942000000000007, ('S', 'Y'): 0.00039989000000000002, ('W', 'N'): 4.0000000000000009e-07, ('D', 'Y'): 2.7100000000000003e-06, ('E', 'Q'): 0.0069153999999999995, ('K', 'Y'): 0.00020036000000000001, ('S', 'G'): 0.0031739600000000008, ('Y', 'S'): 0.00019983000000000004, ('G', 'R'): 0.00020277000000000001, ('A', 'L'): 0.00079790000000000004, ('A', 'G'): 0.0041676400000000002, ('T', 'K'): 0.0015896300000000003, ('T', 'P'): 0.0010014200000000003, ('M', 'V'): 0.00079430000000000017, ('Q', 'L'): 0.00059621000000000023, ('E', 'S'): 0.0007988800000000004, ('H', 'W'): 0.00019993000000000002, ('I', 'D'): 0.00020056000000000004, ('K', 'F'): 1.9300000000000002e-06, ('N', 'A'): 0.00080028999999999994, ('T', 'I'): 0.0021806200000000007, ('Q', 'N'): 0.00079922000000000044, ('K', 'W'): 3.6900000000000002e-06, ('S', 'C'): 0.0021812700000000003, ('Y', 'Y'): 0.98903664000000013, ('G', 'V'): 0.00099697999999999996, ('L', 'V'): 0.0029874000000000003, ('A', 'R'): 0.00040374000000000003, ('M', 'R'): 0.00019997000000000003, ('Y', 'L'): 0.00020053000000000001, ('D', 'C'): 9.200000000000003e-07, ('P', 'P'): 0.98526108000000012, ('D', 'H'): 0.00080255000000000018, ('Q', 'Q'): 0.9753710699999999, ('I', 'V'): 0.0065281099999999993, ('P', 'F'): 0.00019992999999999999, ('I', 'A'): 0.00040185000000000004, ('F', 'F'): 0.98923661000000007, ('K', 'T'): 0.0021855500000000001, ('L', 'T'): 0.00060080000000000008, ('S', 'Q'): 0.00080027999999999989, ('W', 'F'): 0.00019948000000000003, ('D', 'A'): 0.0011944200000000001, ('E', 'Y'): 0.00019891000000000003, ('K', 'A'): 0.00040459000000000003, ('Q', 'S'): 0.00040041999999999996, ('A', 'D'): 0.0019924400000000003, ('L', 'R'): 0.00020202000000000002, ('T', 'S'): 0.0063204099999999994, ('A', 'V'): 0.0035668800000000001, ('M', 'N'): 2.2200000000000003e-06, ('Q', 'D'): 0.0010050700000000001, ('E', 'P'): 0.00059990000000000022, ('V', 'V'): 0.98032286000000013, ('D', 'N'): 0.0082748500000000003, ('I', 'S'): 0.00020221000000000003, ('P', 'M'): 0.00020187000000000004, ('H', 'D'): 0.00060148000000000016, ('I', 'L'): 0.0017890800000000002, ('K', 'N'): 0.0049460400000000005, ('L', 'P'): 0.00059832000000000006, ('Y', 'I'): 0.00020098000000000002, ('N', 'I'): 0.00059451000000000003, ('T', 'Q'): 0.00059926000000000022, ('Q', 'F'): 1.3100000000000002e-06, ('S', 'M'): 0.00079606000000000013, ('E', 'R'): 5.8499999999999999e-06, ('Q', 'W'): 1.2100000000000003e-06, ('G', 'N'): 0.0023863300000000003, ('L', 'Y'): 0.00040249000000000009, ('L', 'N'): 0.00059679000000000015, ('A', 'S'): 0.0069189100000000003, ('D', 'T'): 0.00060143999999999996, ('S', 'T'): 0.0075052800000000005, ('P', 'S'): 0.0023795599999999997, ('V', 'R'): 0.00039940000000000006, ('D', 'K'): 0.00060241000000000016, ('P', 'H'): 0.00099553000000000033, ('H', 'C'): 0.00019926000000000007, ('Q', 'I'): 0.00020090000000000003, ('H', 'H'): 0.9824872600000002, ('I', 'I'): 0.97458704000000018, ('L', 'W'): 0.00079755000000000006, ('L', 'L'): 0.98943667000000013, ('D', 'R'): 3.27e-06, ('S', 'I'): 0.00040412, ('D', 'I'): 0.00020171000000000005, ('E', 'A'): 0.0019811500000000001, ('K', 'I'): 0.00079749000000000009, ('Q', 'K'): 0.0011925600000000003, ('T', 'D'): 0.00080057000000000001, ('A', 'W'): 2.2799999999999998e-06, ('Y', 'R'): 8.3000000000000021e-07, ('M', 'F'): 0.00019971000000000002, ('S', 'P'): 0.0033708400000000008, ('H', 'Q'): 0.0039602400000000012, ('Y', 'N'): 0.00059464000000000023, ('I', 'P'): 2.57e-06, ('E', 'C'): 1.0000000000000004e-06, ('H', 'G'): 2.03e-06, ('P', 'E'): 0.00059995999999999997, ('Q', 'M'): 0.00079392000000000004, ('H', 'L'): 0.00019987000000000002, ('L', 'S'): 0.00020276000000000004, ('L', 'H'): 0.00079759000000000004, ('N', 'Q'): 0.00079987999999999999, ('T', 'Y'): 0.00039870000000000004, ('K', 'G'): 0.00040150000000000006, ('S', 'E'): 0.0011969000000000003, ('Y', 'E'): 0.00019861999999999999, ('W', 'R'): 0.00039790000000000002, ('V', 'M'): 0.0033754800000000006, ('N', 'R'): 0.00020694000000000002, ('G', 'F'): 0.00020026000000000001, ('F', 'Y'): 0.0055699100000000008, ('L', 'Q'): 0.0011930500000000002, ('M', 'Y'): 6.9000000000000017e-07, ('A', 'P'): 0.0043648000000000003, ('D', 'G'): 0.0011945700000000003, ('C', 'L'): 4.9000000000000007e-07, ('L', 'F'): 0.0025889700000000003, ('D', 'W'): 7.1000000000000008e-07, ('S', 'L'): 0.00020189000000000001, ('P', 'R'): 0.00099562000000000023, ('P', 'K'): 0.00040050999999999992, ('Y', 'G'): 8.6000000000000013e-07, ('C', 'K'): 7.1000000000000008e-07, ('H', 'K'): 0.00020382999999999998, ('Q', 'A'): 0.00059816000000000003, ('I', 'F'): 0.0013892800000000001, ('K', 'D'): 0.0012021800000000002, ('N', 'C'): 2.92e-06, ('L', 'D'): 3.1800000000000005e-06, ('F', 'V'): 4.3800000000000004e-06, ('S', 'A'): 0.0055351900000000006, ('W', 'V'): 4.9999999999999998e-08, ('E', 'I'): 0.0005957400000000002, ('V', 'I'): 0.011276180000000002, ('Q', 'C'): 7.7000000000000004e-07, ('T', 'G'): 0.00040755000000000007, ('T', 'L'): 0.00040057, ('L', 'M'): 0.0089262900000000017, ('A', 'T'): 0.0063353700000000008, ('C', 'H'): 0.00019931000000000001, ('P', 'Y'): 1.3100000000000002e-06, ('S', 'H'): 0.00040704000000000006, ('H', 'Y'): 0.00079571999999999998, ('E', 'K'): 0.00079726999999999988, ('C', 'G'): 1.1100000000000002e-06, ('I', 'C'): 0.00039818000000000009, ('Q', 'E'): 0.0053345999999999992, ('K', 'R'): 0.00734354, ('T', 'E'): 0.00040538999999999999, ('L', 'K'): 0.00040132000000000004, ('M', 'W'): 4.8000000000000006e-07, ('N', 'Y'): 0.00079273000000000006, ('N', 'H'): 0.0041479600000000009, ('V', 'E'): 0.00040065000000000006, ('Q', 'G'): 0.00020102000000000005, ('Y', 'D'): 1.99e-06, ('F', 'Q'): 1.2800000000000002e-06, ('G', 'Y'): 1.9400000000000005e-06, ('L', 'I'): 0.0043728899999999999, ('M', 'Q'): 0.00039637000000000006, ('R', 'A'): 0.00020132000000000003, ('C', 'D'): 5.6000000000000004e-07, ('S', 'V'): 0.00040639999999999996, ('D', 'D'): 0.97204597000000026, ('S', 'D'): 0.0014015000000000004, ('P', 'C'): 0.00020093999999999998, ('C', 'C'): 0.99460808000000023, ('W', 'K'): 4.5000000000000003e-07, ('I', 'N'): 0.00059407000000000004, ('K', 'L'): 0.00020234000000000004, ('N', 'K'): 0.0025716500000000008, ('L', 'G'): 0.00020063000000000004, ('M', 'S'): 0.00019878000000000002, ('R', 'C'): 0.00019979000000000004, ('R', 'D'): 2.9400000000000002e-06, ('V', 'A'): 0.0025757500000000003, ('W', 'I'): 1.7000000000000001e-07, ('T', 'T'): 0.97439006000000017, ('F', 'M'): 0.00079671000000000017, ('L', 'E'): 0.00020165000000000002, ('M', 'M'): 0.97496482000000018, ('R', 'E'): 4.95e-06, ('W', 'H'): 2.8000000000000002e-07, ('S', 'R'): 0.0021789800000000005, ('E', 'W'): 3.5000000000000004e-07, ('P', 'Q'): 0.00158898, ('H', 'A'): 0.00020061000000000002, ('N', 'D'): 0.0070930100000000003, ('E', 'H'): 0.00040801000000000005, ('R', 'F'): 0.00019952000000000001, ('I', 'K'): 0.00039856000000000006, ('N', 'E'): 0.0012051700000000006, ('T', 'M'): 0.0011929800000000002, ('T', 'R'): 0.00040384999999999998, ('M', 'T'): 0.00039709000000000001, ('G', 'S'): 0.0041651300000000004, ('L', 'C'): 1.2700000000000001e-06, ('R', 'G'): 1.8600000000000002e-06, ('Y', 'M'): 1.7500000000000002e-06, ('N', 'F'): 0.00020016000000000001, ('Y', 'Q'): 1.5100000000000004e-06, ('N', 'P'): 0.00040177000000000002, ('R', 'H'): 0.00198584, ('W', 'M'): 1.6e-07, ('C', 'N'): 2.2699999999999999e-06, ('V', 'L'): 0.0021908300000000004, ('F', 'I'): 0.0015875100000000001, ('G', 'Q'): 0.00060148999999999999, ('L', 'A'): 0.00059944000000000013, ('M', 'I'): 0.00099193000000000003, ('R', 'I'): 0.00059584999999999998, ('W', 'L'): 1.0000000000000001e-07, ('S', 'N'): 0.0067007399999999993, ('D', 'L'): 1.8300000000000001e-06, ('I', 'R'): 0.00039781000000000001, ('C', 'M'): 8.300000000000001e-07, ('H', 'E'): 0.00020632000000000002, ('Y', 'W'): 0.00039920999999999999, ('G', 'P'): 0.00060523000000000011, ('W', 'C'): 1.6e-07, ('M', 'P'): 1.1300000000000002e-06, ('N', 'S'): 0.00394174, ('G', 'W'): 1.3300000000000002e-06, ('M', 'K'): 0.00079286000000000005, ('R', 'K'): 0.0037710899999999999, ('D', 'E'): 0.010459979999999999, ('K', 'E'): 0.0013947, ('R', 'L'): 0.00020016000000000001, ('A', 'I'): 0.0012015300000000001, ('V', 'Y'): 0.00039877000000000001, ('W', 'A'): 3.2000000000000006e-07, ('Y', 'F'): 0.0041775099999999997, ('T', 'W'): 2.0500000000000003e-06, ('V', 'H'): 0.00059650999999999997, ('F', 'E'): 9.6000000000000013e-07, ('M', 'E'): 1.3500000000000004e-06, ('R', 'M'): 0.00079710000000000002, ('E', 'T'): 0.00040361999999999999, ('H', 'R'): 0.0015887300000000004, ('P', 'I'): 0.00020163000000000001, ('F', 'T'): 0.00020050000000000002, ('C', 'I'): 0.00019993000000000002, ('H', 'I'): 2.3e-06, ('G', 'T'): 0.00061142000000000011, ('I', 'H'): 2.8600000000000001e-06, ('R', 'N'): 0.00020678000000000005, ('C', 'W'): 4.0000000000000003e-07, ('W', 'G'): 1.7000000000000001e-07, ('Y', 'H'): 0.00079549999999999998, ('M', 'L'): 0.00158683, ('G', 'K'): 0.00040206999999999998, ('M', 'G'): 7.1999999999999999e-07, ('K', 'S'): 0.0015946200000000004, ('E', 'V'): 0.00039986999999999998, ('N', 'N'): 0.96474893000000039, ('V', 'K'): 0.00020240000000000001, ('R', 'P'): 0.00079641000000000011, ('A', 'M'): 0.0011948400000000002, ('W', 'E'): 7.0000000000000005e-08, ('F', 'W'): 0.00059867000000000004, ('C', 'F'): 9.4000000000000011e-07, ('V', 'D'): 0.00020210000000000003, ('F', 'A'): 0.00019985000000000003, ('G', 'I'): 6.0700000000000003e-06, ('M', 'A'): 0.00019914999999999999, ('R', 'Q'): 0.0019840799999999996, ('C', 'T'): 0.00020102000000000002, ('W', 'D'): 7.0000000000000005e-08, ('H', 'V'): 0.00019921000000000001, ('S', 'F'): 0.0005961400000000001, ('P', 'T'): 0.00080178000000000009, ('F', 'P'): 9.4000000000000011e-07, ('C', 'E'): 6.200000000000001e-07, ('H', 'M'): 2.2199999999999999e-06, ('I', 'E'): 0.00039716000000000008, ('G', 'H'): 0.00020364000000000002, ('R', 'R'): 0.98268564000000025, ('K', 'P'): 0.00060106000000000016, ('C', 'S'): 0.00099159000000000009, ('D', 'V'): 0.00020131000000000004, ('M', 'H'): 1.1600000000000001e-06, ('M', 'C'): 3.9000000000000008e-07, ('R', 'S'): 0.0011886000000000004, ('D', 'M'): 2.4700000000000001e-06, ('E', 'E'): 0.97322457000000007, ('K', 'M'): 0.0039642800000000006, ('V', 'G'): 0.00059875000000000011, ('R', 'T'): 0.00020352000000000003, ('A', 'A'): 0.97360669, ('V', 'Q'): 0.00040057999999999999, ('W', 'Y'): 0.00019950999999999999, ('F', 'S'): 0.00039737000000000008, ('G', 'M'): 0.00020237, ('C', 'P'): 0.00020023999999999999, ('E', 'G'): 0.00079912000000000017, ('I', 'W'): 8.300000000000001e-07, ('P', 'A'): 0.0025789400000000009, ('F', 'L'): 0.0011950300000000001, ('C', 'A'): 0.00020048, ('G', 'L'): 0.00020100000000000003, ('R', 'V'): 0.00020033000000000003, ('T', 'F'): 0.00020141000000000004, ('Y', 'P'): 7.4000000000000011e-07, ('M', 'D'): 6.8000000000000005e-07, ('G', 'C'): 0.00020225000000000004, ('R', 'W'): 0.0015916000000000001, ('Y', 'A'): 0.00019930000000000002, ('N', 'V'): 0.00020155000000000005, ('V', 'C'): 0.00059823999999999999, ('A', 'E'): 0.0033680100000000003, ('N', 'M'): 5.5400000000000003e-06, ('D', 'P'): 0.00020337999999999999, ('G', 'A'): 0.0041680500000000004, ('R', 'Y'): 1.2500000000000001e-06, ('P', 'W'): 1.1800000000000001e-06, ('Y', 'C'): 0.00059778000000000023, ('P', 'L'): 0.00039906000000000002, ('F', 'H'): 0.00039891000000000004, ('I', 'M'): 0.0023805800000000002, ('Y', 'T'): 0.00019963000000000001, ('N', 'G'): 0.00119243, ('W', 'S'): 0.00019831000000000002}
In[6]: def check_power(n):
    return expected_changes(p**n, pam_freqs)
In[7]: check_power(1)
In[8]: def check_power(n):
    return expected_changes(p**n, pam_freq)
In[9]: check_power(1)
Out[9]: 0.010008099999999947
In[10]: check_power(10)
Out[10]: 0.094213372320860689
In[11]: check_power(40)
Out[11]: 0.31247404355413122
In[12]: expected_changes(d, pi_out)
In[13]: d = parse_david('MTMout40.p')
In[14]: expected_changes(d, pi_out)
Out[14]: 0.36227122609440005
In[15]: check_power(45)
Out[15]: 0.34140113205592099
In[16]: check_power(46)
Out[16]: 0.34697474885444729
In[17]: check_power(50)
Out[17]: 0.36859719118117923
In[18]: check_power(49)
Out[18]: 0.3632904205082419
In[19]: check_power(48)
Out[19]: 0.35791840308604861
In[20]: expected_changes(d, pi_out) - expected_changes(p**40, pam_freq)
Out[20]: 0.049797182540268825
In[21]: expected_changes(d, pi_out) - expected_changes(p**49, pam_freq)
Out[21]: -0.00101919441384
